# For full config options, check the docs:
#    docs.serverless.com

# the service name is used as a prefix for infrastructure created via
# CloudFormation. Some infrastructure has limits on name length so don't make
# the service name too long
service: projectworks-leave-notify
frameworkVersion: '2'
provider:
  name: aws
  region: ap-southeast-2
  runtime: nodejs12.x
  lambdaHashingVersion: "20201221" # this will be default in serverless v3
  logRetentionInDays: 14 # Set the default RetentionInDays for a CloudWatch LogGroup
  deploymentBucket:
    # name: com.serverless.${self:provider.region}.deploys # Deployment bucket name. Default is generated by the framework
    blockPublicAccess: true # Prevents public access via ACLs or bucket policies. Default is false
    serverSideEncryption: AES256 # server-side encryption method
    tags: # Tags that will be added to each of the deployment resources
      ProvisionedBy: Serverless
      Project: projectworks-leave-notifications
  stackTags: # Optional CF stack tags
    ProvisionedBy: Serverless
    Project: projectworks-leave-notifications
  tags: # service wide tags
    ProvisionedBy: Serverless
    Project: projectworks-leave-notifications
package:
  exclude:
    - .env
functions:
  weeklyReport:
    handler: handler.weeklyReport
    events:
      # Run weekly, Sunday 19:00 UTC (Monday 7/8am in NZ)
      - schedule: cron(0 19 ? * 1 *)
  dailyReport:
    handler: handler.dailyReport
    events:
      # Run daily on week days, 19:00 UTC (7/8am in NZ)
      - schedule: cron(0 19 ? * 1-5 *)
plugins:
  - serverless-dotenv-plugin